<% provide(:title, 'Reset password') %>

<div class="container">
  <h1>Reset password</h1>

  <div class="row">
    <%= form_for(@user, url: password_reset_path(params[:id])) do |f| %>
      <%
        field_info = {}
        flash.to_hash["form"]&.each do |field, messages|
          field_info[field] = {
            message: "#{field.capitalize} #{messages.first}",
            valid: "invalid"
          }
        end
      %>

      <%= hidden_field_tag :email, @user.email %>

      <div class="input-field">
        <%= f.label :password %>
        <%= f.password_field :password, class: "validate #{field_info.dig(:password, :valid)} form-control" %>
        <% if field_info.dig(:password) %>
          <span class="helper-text" data-error="<%= field_info[:password][:message] %>"></span>
        <% end %>
      </div>

      <div class="input-field">
        <%= f.label :password_confirmation, "Confirmation" %>
        <%= f.password_field :password_confirmation, class: "validate #{field_info.dig(:password, :valid)} form-control" %>
      </div>

      <%= button_tag 'SUBMIT', class: 'btn waves-effect waves-light', type: 'button', onclick: 'submit();' %>
    <% end %>
  </div>
</div>